<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sports Match Predictor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Custom styles for specific effects */
        .text-shadow { text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7); }
        .hover-lift { transition: transform 0.3s ease, box-shadow 0.3s ease; }
        .hover-lift:hover { transform: translateY(-5px); box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2); }
        .hover-zoom { transition: transform 0.3s ease; }
        .hover-zoom:hover { transform: scale(1.1); }
        .custom-scrollbar::-webkit-scrollbar { width: 8px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(0, 0, 0, 0.3); border-radius: 4px; }
        .custom-scrollbar { scrollbar-width: thin; scrollbar-color: rgba(0, 0, 0, 0.3) transparent; }
        .focus-blue:focus { outline: none; ring: 2px solid #3b82f6; box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3); }
        body { min-height: 100vh; display: flex; flex-direction: column; }
        footer { margin-top: auto; }
    </style>
    <script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
            return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
            if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
                try {
                    var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                    var firstSheetName = workbook.SheetNames[0];
                    var worksheet = workbook.Sheets[firstSheetName];
                    // Convert sheet to JSON to filter blank rows
                    var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                    // Filter out blank rows (rows where all cells are empty, null, or undefined)
                    var filteredData = jsonData.filter(row => row.some(filledCell));
                    // Heuristic to find the header row
                    var headerRowIndex = filteredData.findIndex((row, index) =>
                        row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                    );
                    if (headerRowIndex === -1 || headerRowIndex > 25) {
                        headerRowIndex = 0;
                    }
                    // Convert filtered JSON back to CSV
                    var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex));
                    csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                    return csv;
                } catch (e) {
                    console.error(e);
                    return "";
                }
            }
            return gk_fileData[filename] || "";
        }
    </script>
</head>
<body class="bg-gray-100 font-sans text-gray-800">
    <!-- Main Page -->
    <div id="main-page">
        <!-- Header Section -->
        <header class="relative bg-cover bg-center h-48" style="background-image: url('https://yourwebsite.com/your-image.webp');">
            <div class="absolute inset-0 bg-black opacity-40"></div>
            <h1 class="relative text-4xl font-bold text-white text-center py-16 text-shadow">Sports Match Predictor</h1>
        </header>
        <!-- Main Content -->
        <main class="max-w-7xl mx-auto p-6 flex-1">
            <!-- Search Bar -->
            <section class="mb-8">
                <input
                    id="search-input"
                    type="text"
                    placeholder="Search for a match..."
                    class="w-full p-4 rounded-lg bg-white shadow focus-blue text-gray-700 placeholder-gray-400"
                >
            </section>
            <!-- Sports Filter Section (Horizontal Scroll) -->
            <section class="mb-8">
                <h2 class="text-xl font-semibold mb-4">Filter by Sport</h2>
                <div class="flex overflow-x-auto space-x-4 pb-4 custom-scrollbar">
                    <button class="bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-700 hover-zoom transition flex-shrink-0" onclick="filterMatches('Football')">Football</button>
                    <button class="bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-700 hover-zoom transition flex-shrink-0" onclick="filterMatches('Basketball')">Basketball</button>
                    <button class="bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-700 hover-zoom transition flex-shrink-0" onclick="filterMatches('Hockey')">Hockey</button>
                    <button class="bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-700 hover-zoom transition flex-shrink-0" onclick="filterMatches('Tennis')">Tennis</button>
                    <button class="bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-700 hover-zoom transition flex-shrink-0" onclick="filterMatches('Volleyball')">Volleyball</button>
                    <button class="bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-700 hover-zoom transition flex-shrink-0" onclick="filterMatches('Baseball')">Baseball</button>
                    <button class="bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-700 hover-zoom transition flex-shrink-0" onclick="filterMatches('American Football')">American Football</button>
                    <button class="bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-700 hover-zoom transition flex-shrink-0" onclick="filterMatches('Rugby Union')">Rugby Union</button>
                    <button class="bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-700 hover-zoom transition flex-shrink-0" onclick="filterMatches('Cricket')">Cricket</button>
                    <button class="bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-700 hover-zoom transition flex-shrink-0" onclick="filterMatches('Handball')">Handball</button>
                    <button class="bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-700 hover-zoom transition flex-shrink-0" onclick="filterMatches('All')">All</button>
                </div>
            </section>
            <!-- Upcoming Matches Section -->
            <section class="mb-8">
                <h2 class="text-xl font-semibold mb-4">Upcoming Matches</h2>
                <div id="matches" class="space-y-4 max-h-96 overflow-y-auto custom-scrollbar"></div>
            </section>
            <!-- Link to Statistics Page -->
            <section class="mb-8 flex justify-center">
                <button onclick="showPage('stats-page')" class="bg-green-500 text-white py-2 px-6 rounded hover:bg-green-700 transition">View Prediction Statistics</button>
            </section>
        </main>
    </div>
    <!-- Download Page -->
    <div id="download-page" class="hidden min-h-screen flex items-center justify-center">
        <div class="bg-white p-8 rounded-lg shadow-lg max-w-md w-full text-center">
            <h2 class="text-2xl font-semibold mb-4">Download Required</h2>
            <p class="text-gray-600 mb-6">To view match results, please download the SportsMatchPredictorApp.</p>
            <div class="flex justify-center space-x-4">
                <button onclick="downloadApp()" class="bg-blue-500 text-white py-2 px-6 rounded hover:bg-blue-700 transition">Download App</button>
                <a href="#" onclick="showPage('main-page')" class="text-blue-500 py-2 px-4">Cancel</a>
            </div>
        </div>
    </div>
    <!-- Statistics Page -->
    <div id="stats-page" class="hidden">
        <main class="max-w-7xl mx-auto p-6 flex-1">
            <section class="mb-8 bg-white p-6 rounded-lg shadow-lg">
                <h2 class="text-xl font-semibold mb-4">Prediction Statistics</h2>
                <div class="mb-6">
                    <h3 class="text-lg font-medium mb-2">Accuracy Over Time</h3>
                    <canvas id="accuracyChart" class="w-full h-64"></canvas>
                </div>
                <div>
                    <h3 class="text-lg font-medium mb-2">Statistics</h3>
                    <ul class="list-disc pl-6">
                        <li>Last Month: 78% accuracy across 150 predictions.</li>
                        <li>Last Year: 82% accuracy across 1800 predictions.</li>
                    </ul>
                </div>
            </section>
            <section class="mb-8 flex justify-center">
                <button onclick="showPage('main-page')" class="bg-blue-500 text-white py-2 px-6 rounded hover:bg-blue-700 transition">Back to Matches</button>
            </section>
        </main>
    </div>
    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-4 text-center">
        <p>© 2025 Sports Match Predictor. All rights reserved.</p>
    </footer>
    <script>
        // Mock data (since I can't fetch from Flashscore directly due to CORS and scraping limitations)
        let matchesData = [
            {
                id: "g_1_prBWju7N",
                sport: "Football",
                time: "21:30",
                date: "2025-05-16",
                team1: "Aston Villa",
                team1Icon: "https://static.flashscore.com/res/image/data/UHchCEVH-jwz95gs0.png",
                team2: "Tottenham",
                team2Icon: "https://static.flashscore.com/res/image/data/v3SzDxVH-Ig5FKJZ5.png"
            },
            {
                id: "g_1_abc12345",
                sport: "Football",
                time: "18:00",
                date: "2025-05-16",
                team1: "Ranheim",
                team1Icon: "https://static.flashscore.com/res/image/data/ranheim-icon.png",
                team2: "Raufoss",
                team2Icon: "https://static.flashscore.com/res/image/data/raufoss-icon.png"
            },
            {
                id: "g_1_def67890",
                sport: "Basketball",
                time: "20:00",
                date: "2025-05-17",
                team1: "Lakers",
                team1Icon: "https://static.flashscore.com/res/image/data/lakers-icon.png",
                team2: "Celtics",
                team2Icon: "https://static.flashscore.com/res/image/data/celtics-icon.png"
            }
        ];

        // Function to fetch matches (mocked due to CORS; replace with backend proxy in production)
        async function fetchMatches() {
            // In production, use a backend proxy to scrape https://www.flashscore.com/
            // Example proxy endpoint: const response = await fetch('https://your-backend.com/api/flashscore-matches');
            // const data = await response.json();
            const data = matchesData;
            displayMatches(data);
        }

        // Function to filter matches by sport
        function filterMatches(sport) {
            const filtered = sport === "All" ? matchesData : matchesData.filter(match => match.sport === sport);
            displayMatches(filtered);
        }

        // Function to display matches
        function displayMatches(matches) {
            const matchesDiv = document.getElementById('matches');
            matchesDiv.innerHTML = matches.map(match => `
                <div class="bg-white p-4 rounded-lg shadow hover-lift flex justify-between items-center">
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center space-x-2">
                            <img src="${match.team1Icon}" alt="${match.team1}" class="w-6 h-6">
                            <span>${match.team1}</span>
                        </div>
                        <span>vs</span>
                        <div class="flex items-center space-x-2">
                            <img src="${match.team2Icon}" alt="${match.team2}" class="w-6 h-6">
                            <span>${match.team2}</span>
                        </div>
                    </div>
                    <div class="text-right">
                        <p><strong>${match.sport}</strong></p>
                        <p>${match.date} ${match.time}</p>
                        <button onclick="viewPredictions('${match.team1}', '${match.team2}')" class="bg-blue-500 text-white py-1 px-3 rounded hover:bg-blue-700 transition mt-2">View Predictions</button>
                    </div>
                </div>
            `).join('');
        }

        // Function to generate predictions
        function generatePredictions(team1, team2) {
            return encodeURIComponent(
                `${team1} Win: 65%|${team1} At Least One Card: 15%|${team1} 2 Rounds: 45%|` +
                `${team2} Win: 55%|${team2} At Least One Card: 25%|${team2} 2 Rounds: 30%|` +
                `Exact Score|3-0: 25%|3-1: 30%|2-1: 32%|1-1: 13%`
            );
        }

        // Function to view predictions
        function viewPredictions(team1, team2) {
    const isDesktop = !/Mobi|Android|iPhone|iPad|iPod/.test(navigator.userAgent) && window.innerWidth > 1024;
    if (isDesktop) {
        alert('Please open this website on a mobile device to view predictions.');
        return;
    }
    const predictions = generatePredictions(team1, team2);
    // ИСПОЛЬЗУЕМ deep link, который прописан в AndroidManifest.xml
    const deepLink = `https://tukuafuchristine047.github.io/sports-match-predictor.github.io/predictions?match=${predictions}`;
    const downloadPage = 'download-page';
    window.location = deepLink;
    setTimeout(() => {
        if (document.hasFocus()) {
            showPage(downloadPage);
        }
    }, 2000);
}

        // Function to handle app download
        function downloadApp() {
            const isDesktop = !/Mobi|Android|iPhone|iPad|iPod/.test(navigator.userAgent) && window.innerWidth > 1024;
            if (isDesktop) {
                alert('Please open this website on a mobile device to download the app.');
                return;
            }
            window.location = 'https://github.com/tukuafuchristine047/apk_release/releases/download/app/app-release.apk'; // Replace with actual app store link
        }

        // Function to show/hide pages
        function showPage(pageId) {
            document.getElementById('main-page').classList.add('hidden');
            document.getElementById('download-page').classList.add('hidden');
            document.getElementById('stats-page').classList.add('hidden');
            document.getElementById(pageId).classList.remove('hidden');
        }

        // Initialize Chart.js for Statistics Page
        function initChart() {
            const ctx = document.getElementById('accuracyChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Last Month', 'Last Year'],
                    datasets: [{
                        label: 'Accuracy (%)',
                        data: [78, 82],
                        backgroundColor: ['#3b82f6', '#10b981'],
                        borderColor: ['#2563eb', '#059669'],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            title: { display: true, text: 'Accuracy (%)' }
                        },
                        x: {
                            title: { display: true, text: 'Time Period' }
                        }
                    }
                }
            });
        }

        // Load matches and initialize chart on page load
        window.onload = () => {
            fetchMatches();
            initChart();
        };
    </script>
</body>
</html>
